<!doctype html>
<html lang="es">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="author" content="Juan Salvador Aleixandre" />
    <meta name="date" content="09/11/2015"/>
    <meta name="generator" content="easybook 4.9.0"/>

    <title>Log4net con <strong>C#</strong> | Blog Cosillas de Juansal</title>

    <link rel="stylesheet" href="./css/easybook.css" />

</head>

<body class="item chapter">
<div class="container">
<div class="menu">
    <div class="row">
        <h1 class="span9"><a href="./index.html">Blog Cosillas de Juansal</a></h1>
        <p class="span3">
                        <a href="./capitulo-43.html"><span>&larr;</span> Anterior</a>
            
                        <a href="./capitulo-45.html">Siguiente <span>&rarr;</span></a>
                    </p>
    </div>
</div>

<div class="row">
    <div class="span9">
        <h1 id="2013_01"><span>Capítulo 4.4</span> Log4net con <strong>C#</strong></h1>
        <p>Para poder utilizar el Log4net en una aplicación de C# se han de seguir los siguientes pasos.</p>

<p>Añadir el log4net a las referencias del proyecto.</p>

<p>En el fichero <code>AssemblyInfo.cs</code> añadir la siguiente línea:</p>

<p><code>csharp
[assembly: log4net.Config.XmlConfigurator(ConfigFile = "Configuracion.log4net", Watch = true)]</code></p>

<p>Esta línea hace que se cargue la configuración del Log4net desde el fichero <code>Configuracion.log4net</code>.</p>

<p>En la declaración de las variables de las clases añadir:</p>

<p><code>csharp
private readonly ILog LogPagina = LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);</code></p>

<p>Por cada salida de log realizar la siguiente llamada:</p>

<p><code>csharp
LogPagina.debug(texto_a_sacar_por_log);
LogPagina.info(texto_a_sacar_por_log);
LogPagina.warn(texto_a_sacar_por_log);
LogPagina.error(texto_a_sacar_por_log);
LogPagina.fatal(texto_a_sacar_por_log);</code></p>

<p>Si queremos que en una excepción se imprima el error que contiene el objeto excepción:</p>

<p><code>csharp
LogPagina.debug(texto_a_sacar_por_log, excepción);
LogPagina.info(texto_a_sacar_por_log, excepción);
LogPagina.warn(texto_a_sacar_por_log, excepción);
LogPagina.error(texto_a_sacar_por_log, excepción);
LogPagina.fatal(texto_a_sacar_por_log, excepción);</code></p>

<p>El fichero de configuración del Log4Net ha de llamarse <code>Configuracion.log4net</code> y ha de estar situado en la raiz del proyecto.</p>

<p><code>xml
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;log4net&gt;
  &lt;appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender"&gt;
    &lt;file value="log\Mtmnet.log" /&gt;
    &lt;appendToFile value="true" /&gt;
    &lt;rollingStyle value="Size" /&gt;
    &lt;maxSizeRollBackups value="10" /&gt;
    &lt;maximumFileSize value="10MB" /&gt;
    &lt;staticLogFileName value="true" /&gt;
    &lt;layout type="log4net.Layout.PatternLayout"&gt;
      &lt;conversionPattern value="%d [%t] %-5p %c - %m%n" /&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;
  &lt;root&gt;
    &lt;level value="ALL" /&gt;
    &lt;appender-ref ref="RollingLogFileAppender" /&gt;
  &lt;/root&gt;
&lt;/log4net&gt;</code></p>

    </div>

    <div class="span3">
        <div class="item local_toc">
            <h3>Índice de contenidos</h3>

            <ul class="unstyled">
                                                <li class="level-1">
                        <span></span>
                        <a class="internal" href="./capitulo-44.html#2013_01">Log4net con <strong>C#</strong></a>
                    </li>
                                        </ul>
        </div>
    </div>
</div>
</div>
</body>
</html>