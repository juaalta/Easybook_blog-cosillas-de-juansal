<!doctype html>
<html lang="es">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="author" content="Juan Salvador Aleixandre" />
    <meta name="date" content="09/11/2015"/>
    <meta name="generator" content="easybook 4.9.0"/>

    <title>Lectura de ficheros INI sin secciones con Inno Setup desde código (continuación) | Blog Cosillas de Juansal</title>

    <link rel="stylesheet" href="./css/easybook.css" />

</head>

<body class="item chapter">
<div class="container">
<div class="menu">
    <div class="row">
        <h1 class="span9"><a href="./index.html">Blog Cosillas de Juansal</a></h1>
        <p class="span3">
                        <a href="./capitulo-28.html"><span>&larr;</span> Anterior</a>
            
                        <a href="./capitulo-21.html">Siguiente <span>&rarr;</span></a>
                    </p>
    </div>
</div>

<div class="row">
    <div class="span9">
        <h1 id="2010_09"><span>Capítulo 2.9</span> Lectura de ficheros INI sin secciones con Inno Setup desde código (continuación)</h1>
        <p>Este post es una continuación del anterior y voy a añadir un nuevo método, el cual se encarga de comprobar si una etiqueta existe en el fichero.</p>

<div class="code delphi">
<pre class="delphi"><span class="kw1">function</span> ExisteEtiqueta <span class="br0">&#40;</span>Etiqueta<span class="sy1">:</span> <span class="kw4">String</span><span class="br0">&#41;</span><span class="sy1">:</span> <span class="kw4">Boolean</span><span class="sy1">;</span>
<span class="kw1">var</span>
    I<span class="sy1">:</span>        <span class="kw4">LongInt</span><span class="sy1">;</span>
    L<span class="sy1">:</span>        <span class="kw4">LongInt</span><span class="sy1">;</span>
    S<span class="sy1">:</span>        <span class="kw4">String</span><span class="sy1">;</span>
<span class="kw1">begin</span>
    S <span class="sy1">:</span><span class="sy3">=</span> Etiqueta <span class="sy3">+</span> <span class="st0">'='</span><span class="sy1">;</span>
    L <span class="sy1">:</span><span class="sy3">=</span> <span class="kw3">Length</span> <span class="br0">&#40;</span>S<span class="br0">&#41;</span><span class="sy1">;</span>
    <span class="kw1">For</span> I <span class="sy1">:</span><span class="sy3">=</span> <span class="nu0">0</span> <span class="kw1">to</span> GetArrayLength <span class="br0">&#40;</span>ConfigValues<span class="br0">&#41;</span> <span class="sy3">-</span> <span class="nu0">1</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw3">copy</span> <span class="br0">&#40;</span>ConfigValues <span class="br0">&#91;</span>I<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">1</span><span class="sy1">,</span> L<span class="br0">&#41;</span> <span class="sy3">=</span> S<span class="br0">&#41;</span> <span class="kw1">then</span>
        <span class="kw1">begin</span>
            Result <span class="sy1">:</span><span class="sy3">=</span> <span class="kw2">TRUE</span><span class="sy1">;</span>
            Exit<span class="sy1">;</span>
        <span class="kw1">end</span><span class="sy1">;</span>
    <span class="kw1">end</span><span class="sy1">;</span>
    Result <span class="sy1">:</span><span class="sy3">=</span> <span class="kw2">FALSE</span><span class="sy1">;</span>
<span class="kw1">end</span><span class="sy1">;</span></pre>
</div>

    </div>

    <div class="span3">
        <div class="item local_toc">
            <h3>Índice de contenidos</h3>

            <ul class="unstyled">
                                                <li class="level-1">
                        <span></span>
                        <a class="internal" href="./capitulo-29.html#2010_09">Lectura de ficheros INI sin secciones con Inno Setup desde código (continuación)</a>
                    </li>
                                        </ul>
        </div>
    </div>
</div>
</div>
</body>
</html>